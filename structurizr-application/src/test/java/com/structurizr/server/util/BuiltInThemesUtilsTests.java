package com.structurizr.server.util;

import com.structurizr.Workspace;
import com.structurizr.util.BuiltInThemes;
import com.structurizr.view.ElementStyle;
import com.structurizr.view.Shape;
import com.structurizr.view.Themes;
import org.junit.jupiter.api.Test;

import java.util.Set;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertNotNull;

public class BuiltInThemesUtilsTests {

    @Test
    void inlineBuiltInThemes_WhenTheElementStyleDoesNotExist() {
        Themes.setBuiltInThemes(Set.of("amazon-web-services-2025.07"));
        Workspace workspace = new Workspace("Name", "Description");
        workspace.getModel().addSoftwareSystem("Name").addTags("Amazon Web Services - Fargate");
        workspace.getViews().getConfiguration().addTheme("amazon-web-services-2025.07");

        BuiltInThemes.inlineIcons(workspace);

        ElementStyle elementStyle = workspace.getViews().getConfiguration().getStyles().getElementStyle("Amazon Web Services - Fargate");
        assertNotNull(elementStyle);
        assertEquals("data:image/png;base64,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", elementStyle.getIcon());
    }

    @Test
    void inlineBuiltInThemes_WhenTheElementStyleDoeExist() {
        Themes.setBuiltInThemes(Set.of("amazon-web-services-2025.07"));
        Workspace workspace = new Workspace("Name", "Description");
        workspace.getModel().addSoftwareSystem("Name").addTags("Amazon Web Services - Fargate");
        workspace.getViews().getConfiguration().getStyles().addElementStyle("Amazon Web Services - Fargate").shape(Shape.RoundedBox);
        workspace.getViews().getConfiguration().addTheme("amazon-web-services-2025.07");

        BuiltInThemes.inlineIcons(workspace);

        ElementStyle elementStyle = workspace.getViews().getConfiguration().getStyles().getElementStyle("Amazon Web Services - Fargate");
        assertNotNull(elementStyle);
        assertEquals("data:image/png;base64,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", elementStyle.getIcon());
        assertEquals(Shape.RoundedBox, elementStyle.getShape());
    }

}
